<section class="gh-content gh-canvas is-body">
  <p><strong>Gumbel AlphaZero</strong>ì˜ ê°•í™”í•™ìŠµì„ êµ¬í˜„í•´ ë³´ë ¤ê³  í–ˆìœ¼ë‚˜, ì´ë¡ ì´ ì¢€ì²˜ëŸ¼ ì‰½ì§€ ì•Šì•„ì„œ ê³µì‹ ë¦¬í¬ì§€í† ë¦¬ë¥¼ ì°¸ê³ í•˜ë©´ì„œ êµ¬í˜„í•´ ë³´ë ¤ê³  í•©ë‹ˆë‹¤.</p>
  
  <figure class="kg-card kg-bookmark-card">
    <a href="https://github.com/google-deepmind/mctx" class="kg-bookmark-container">
      <div class="kg-bookmark-content">
        <div class="kg-bookmark-title">Mctx: MCTS-in-JAX</div>
        <div class="kg-bookmark-description">Mctx is a library with a JAX-native implementation of Monte Carlo tree search (MCTS) algorithms such as AlphaZero, MuZero, and Gumbel MuZero. For computation speed up, the implementation fully supports JIT-compilation. Search algorithms in Mctx are defined for and operate on batches of inputs, in parallel. This allows to make the most of the accelerators and enables the algorithms to work with large learned environment models parameterized by deep neural networks.</div>
        <div class="kg-bookmark-metadata">
          <img class="kg-bookmark-icon" src="<%= asset_url('octocat.svg') %>" alt="">
          <span class="kg-bookmark-author">GitHub</span>
          <span class="kg-bookmark-publisher">google-deepmind</span>
        </div>
      </div>
      <div class="kg-bookmark-thumbnail">
        <img src="https://opengraph.githubassets.com/1/google-deepmind/mctx" alt="" onerror="this.style.display='none'">
      </div>
    </a>
  </figure>

  <hr>
  
  <figure class="kg-card kg-image-card">
    <%= post_detail_image_tag("gumbel_01.webp") %>
  </figure>

  <h2>1. âš™ Gumbel AlphaZeroë€?</h2>
  <p><code>Gumbel AlphaZero</code>ëŠ” ê¸°ì¡´ì˜ <code>AlphaZero</code>ê°€ ê°€ì§„ ê°•í™”í•™ìŠµì˜ í•œê³„ë¥¼ ê°œì„ í•˜ê¸° ìœ„í•´ ì œì•ˆëœ ìƒˆë¡œìš´ ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤. íŠ¹íˆ ì ì€ ìˆ˜ì˜ ì‹œë®¬ë ˆì´ì…˜ë§Œìœ¼ë¡œë„ ì •ì±…(Policy)ì„ ì´ë¡ ì ìœ¼ë¡œ ê°œì„ í•  ìˆ˜ ìˆë‹¤ëŠ” ê°•ë ¥í•œ ì¥ì ì„ ê°€ì§‘ë‹ˆë‹¤.</p>
  <p>ì´ ê¸€ì—ì„œëŠ” <code>Gumbel AlphaZero</code>ë¥¼ ë„ì…í•˜ëŠ” ê³¼ì • ë° ê·¸ í•µì‹¬ ê°œë…ê³¼ ì•Œê³ ë¦¬ì¦˜ì„ ì •ë¦¬í•©ë‹ˆë‹¤.</p>

  <h2>2. âš™ DeepMind Mctx: JAX ê¸°ë°˜ MCTS ë¼ì´ë¸ŒëŸ¬ë¦¬</h2>
  <p><code>Gumbel AlphaZero</code>ë¥¼ ë¹„ë¡¯í•œ ìµœì‹  íƒìƒ‰ ì•Œê³ ë¦¬ì¦˜ë“¤ì€ ë”¥ë§ˆì¸ë“œì—ì„œ ê°œë°œí•œ <code>Mctx</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬í˜„ë˜ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤. <code>Mctx</code>ëŠ” JAX ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ë˜ì–´ Python í™˜ê²½ì—ì„œ ë†’ì€ ì„±ëŠ¥ê³¼ ìœ ì—°ì„±ì„ ì œê³µí•˜ëŠ” MCTS(Monte Carlo Tree Search) ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤.</p>

  <h3>2.1. Mctx ì†Œê°œ</h3>
  <p><code>Mctx</code>ëŠ” MuZeroì™€ ê°™ì€ ê°•ë ¥í•œ ê°•í™”í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ì„ ì—°êµ¬ìë“¤ì´ ë” ì‰½ê²Œ ì‚¬ìš©í•˜ê³  ë°œì „ì‹œí‚¬ ìˆ˜ ìˆë„ë¡ ë•ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤. C++ ë“±ìœ¼ë¡œ ì‘ì„±ëœ ê¸°ì¡´ì˜ ê³ ì„±ëŠ¥ íƒìƒ‰ ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ ë‹¬ë¦¬, JAXë¥¼ ì‚¬ìš©í•˜ì—¬ Pythonì˜ í¸ì˜ì„±ì„ ìœ ì§€í•˜ë©´ì„œë„ ì»´íŒŒì¼ì„ í†µí•œ ì„±ëŠ¥ ìµœì í™”ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>

  <h3>2.2. í™˜ê²½ êµ¬ì¶•</h3>
  <p>ì´ ê¸€ì˜ ì˜ˆì œ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´, WSL2 Ubuntu 22.04 í™˜ê²½ì— <%= link_to "Miniconda", "https://docs.conda.io/projects/miniconda/en/latest/index.html", class: "next-post-link" %>ë¥¼ ì„¤ì¹˜í•˜ê³  `mctx`ë¼ëŠ” ì´ë¦„ì˜ Conda ê°€ìƒí™˜ê²½ì„ ìƒì„±í•©ë‹ˆë‹¤.</p>
<pre class="language-bash" tabindex="0">
<code class="language-bash">
# Conda ê°€ìƒí™˜ê²½ ìƒì„± ë° í™œì„±í™”
conda create -n mctx python=3.11
conda activate mctx
</code>
</pre>
<p><code>visualization_demo.py</code>ì˜ íƒìƒ‰ íŠ¸ë¦¬ ì‹œê°í™”ì— í•„ìš”í•œ <code>Graphviz</code>ì™€ <code>pygraphviz</code>ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.</p>
<pre class="language-bash" tabindex="0">
<code class="language-bash">
# 1. ì‹œìŠ¤í…œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ (Graphviz)
sudo apt-get update && sudo apt-get install -y graphviz graphviz-dev

# 2. Conda íŒ¨í‚¤ì§€ ì„¤ì¹˜ (pygraphviz)
conda install conda-forge::pygraphviz
</code>
</pre>
<p>ë§ˆì§€ë§‰ìœ¼ë¡œ <code>JAX</code>, <code>Chex</code>, <code>Mctx</code>ë¥¼ <code>pip</code>ìœ¼ë¡œ ì„¤ì¹˜í•©ë‹ˆë‹¤.</p>
<pre class="language-bash" tabindex="0">
<code class="language-bash">
# 3. Pip íŒ¨í‚¤ì§€ ì„¤ì¹˜

# JAX (NVIDIA GPU í™˜ê²½)
pip install "jax[cuda12]"

# JAX (CPU í™˜ê²½, GPUê°€ ì—†ëŠ” ê²½ìš°)
# pip install jax

# Chex ë° Mctx
pip install chex mctx

# ë˜ëŠ” GitHubì—ì„œ ì§ì ‘ ìµœì‹  ê°œë°œ ë²„ì „ ì„¤ì¹˜
# pip install chex git+https://github.com/google-deepmind/mctx.git
</code>
</pre>

  <h2>3. âš™ ê¸°ì¡´ AlphaZeroì˜ í•œê³„</h2>
  <p><code>AlphaZero</code>ì˜ ê°•í™”í•™ìŠµì€ <strong>UCT(Upper Confidence bounds for Trees)</strong> ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ íƒìƒ‰ì„ ìˆ˜í–‰í•˜ê³ , ê·¸ ê²°ê³¼(ë°©ë¬¸ íšŸìˆ˜)ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì •ì±…ì„ ê°œì„ í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ ë°©ì‹ì€ ì‹œë®¬ë ˆì´ì…˜ íšŸìˆ˜ê°€ ì¶©ë¶„íˆ ë§ì§€ ì•Šì„ ê²½ìš°, í•™ìŠµì´ ìš°ì—°íˆ ìƒ˜í”Œë§ëœ í–‰ë™ì—ë§Œ ì˜ì¡´í•˜ê²Œ ë˜ì–´ ì •ì±… ê°œì„ ì„ ì´ë¡ ì ìœ¼ë¡œ ë³´ì¥í•  ìˆ˜ ì—†ëŠ” ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤.</p>
  <p>ì´ëŠ” ê³§, ì œí•œëœ ì‹œê°„ ì•ˆì— ìµœì ì˜ ìˆ˜ë¥¼ ì°¾ì•„ì•¼ í•˜ëŠ” ì‹¤ì œ ëŒ€êµ­ í™˜ê²½ì—ì„œ ì•½ì ìœ¼ë¡œ ì‘ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

  <h2>4. âš™ Gumbel AlphaZeroì˜ í˜ì‹ </h2>
  <p><code>Gumbel AlphaZero</code>ëŠ” ë£¨íŠ¸ ë…¸ë“œ(íƒìƒ‰ì˜ ì‹œì‘ì )ì—ì„œ PUCB(Polynomial Upper Confidence Bound) ëŒ€ì‹  <strong>Gumbel-Top-k</strong>ë¼ëŠ” ìƒˆë¡œìš´ ê¸°ë²•ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë” ì ì€ ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œë„ ì •ì±…ì´ ê°œì„ ë  ê²ƒì„ì„ ì´ë¡ ì ìœ¼ë¡œ ë³´ì¥í•©ë‹ˆë‹¤.</p>
  <p>ë˜í•œ, íƒìƒ‰ ê³¼ì •ì—ì„œ <strong>ìˆœì°¨ì  ë°˜ê°ë²•(Sequential Halving)</strong>ì„ í•¨ê»˜ ì‚¬ìš©í•˜ì—¬ ì œí•œëœ ì‹œë®¬ë ˆì´ì…˜ ì˜ˆì‚°ì„ ê°€ì¥ ìœ ë§í•œ í›„ë³´ ìˆ˜ì— íš¨ìœ¨ì ìœ¼ë¡œ ë°°ë¶„í•©ë‹ˆë‹¤. ì´ ë‘ ê°€ì§€ í•µì‹¬ì ì¸ ë³€í™”ë¥¼ í†µí•´ <code>Gumbel AlphaZero</code>ëŠ” ê¸°ì¡´ <code>AlphaZero</code>ë³´ë‹¤ íš¨ìœ¨ì ì´ê³  ì•ˆì •ì ì¸ í•™ìŠµì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.</p>

  <h2>5. âš™ <code>visualization_demo.py</code>ë¡œ ì´í•´í•˜ëŠ” íƒìƒ‰ ì•Œê³ ë¦¬ì¦˜</h2>
  <p><code>Mctx</code> ê³µì‹ ì €ì¥ì†Œì—ëŠ” <code>Gumbel AlphaZero</code>ì˜ ë™ì‘ì„ ì‹œê°ì ìœ¼ë¡œ ë³´ì—¬ì£¼ëŠ” <code>visualization_demo.py</code> ì˜ˆì œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ ì½”ë“œëŠ” <code>Mctx</code>ì˜ í•µì‹¬ ì •ì±… ì¤‘ í•˜ë‚˜ì¸ <code>gumbel_muzero_policy</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ íƒìƒ‰ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p>
  <p><code>visualization_demo.py</code>ë¥¼ ì‹¤í–‰í•˜ë©´ íƒìƒ‰ ê³¼ì •ì´ ì‹œê°ì ìœ¼ë¡œ ë³´ì—¬ì§€ë©°, íƒìƒ‰ ê²°ê³¼ëŠ” `/tmp/search_tree.png`ì— ì €ì¥ë©ë‹ˆë‹¤.</p>
  <p>ì¶œë ¥ ì˜ˆì‹œ:</p>
<pre class="language-plain" tabindex="0">
<code class="language-plain">
Starting search.
Selected action: 1
Selected action Q-value: 10.666667
Saving tree diagram to: /tmp/search_tree.png
</code>
</pre>
  <figure class="kg-card kg-image-card">
    <%= post_detail_image_tag("search_tree.png") %>
  </figure>

  <h3>5.1. Mctxì˜ í•µì‹¬ êµ¬ì„± ìš”ì†Œ</h3>
  <p><code>Mctx</code>ì˜ ì •ì±… í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ì‚¬ìš©ìê°€ ëª‡ ê°€ì§€ êµ¬ì„± ìš”ì†Œë¥¼ ì§ì ‘ ì •ì˜í•˜ì—¬ ì œê³µí•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” <code>Mctx</code>ê°€ íŠ¹ì • ê²Œì„ì´ë‚˜ í™˜ê²½ì— ì¢…ì†ë˜ì§€ ì•Šê³  ë²”ìš©ì ìœ¼ë¡œ ì‚¬ìš©ë  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ë˜ì—ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>
  <ul>
    <li><code><strong>RootFnOutput</strong></code>: íƒìƒ‰ì„ ì‹œì‘í•˜ëŠ” ë£¨íŠ¸ ë…¸ë“œì˜ ìƒíƒœë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ì •ì±… ë„¤íŠ¸ì›Œí¬ê°€ ì¶œë ¥í•˜ëŠ” <strong>ì •ì±… í™•ë¥ (prior_logits)</strong>, <strong>ìƒíƒœ ê°€ì¹˜(value)</strong>, ê·¸ë¦¬ê³  ìƒíƒœë¥¼ í‘œí˜„í•˜ëŠ” <strong>ì„ë² ë”©(embedding)</strong>ì„ í¬í•¨í•©ë‹ˆë‹¤.</li>
    <li><code><strong>recurrent_fn</strong></code>: í™˜ê²½ì˜ ë™ì—­í•™ ëª¨ë¸ ì—­í• ì„ í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤. í˜„ì¬ ìƒíƒœì˜ <code>embedding</code>ê³¼ ì„ íƒëœ <code>action</code>ì„ ì…ë ¥ë°›ì•„, ë‹¤ìŒ ìƒíƒœì˜ <code>embedding</code>ê³¼ í•¨ê»˜ ì „ì´ ê³¼ì •ì—ì„œ ì–»ëŠ” <strong>ë³´ìƒ(reward)</strong>, <strong>í• ì¸ìœ¨(discount)</strong>, ê·¸ë¦¬ê³  ë‹¤ìŒ ìƒíƒœì˜ <strong>ì •ì±… í™•ë¥ </strong>ê³¼ <strong>ê°€ì¹˜</strong>ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.</li>
  </ul>

  <h3>5.2. í™˜ê²½ ì •ì˜</h3>
  <p>ìƒíƒœ ì „ì´ì™€ ë³´ìƒì€ ì•„ë˜ì™€ ê°™ì´ ì •ì˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
<pre class="language-python" tabindex="0">
<code class="language-python">
# We will define a deterministic toy environment.
# The deterministic `transition_matrix` has shape `[num_states, num_actions]`.
# The `transition_matrix[s, a]` holds the next state.
transition_matrix = jnp.array([
    [1, 2, 3, 4],
    [0, 5, 0, 0],
    [0, 0, 0, 6],
    [0, 0, 0, 0],
    [0, 0, 0, 0],
    [0, 0, 0, 0],
    [0, 0, 0, 0],
], dtype=jnp.int32)
# The `rewards` have shape `[num_states, num_actions]`. The `rewards[s, a]`
# holds the reward for that (s, a) pair.
rewards = jnp.array([
    [1, -1, 0, 0],
    [0, 0, 0, 0],
    [0, 0, 0, 0],
    [0, 0, 0, 0],
    [0, 0, 0, 0],
    [0, 0, 0, 0],
    [10, 0, 20, 0],
], dtype=jnp.float32)
</code>
</pre>

  <p>ì´ 7ê°œì˜ ìƒíƒœê°€ ìˆìœ¼ë©°, <code>transition_matrix</code>ëŠ” ìƒíƒœ ì „ì´ë¥¼, <code>rewards</code>ëŠ” ê° í–‰ë™ì— ëŒ€í•œ ë³´ìƒì„ ì •ì˜í•©ë‹ˆë‹¤.</p>
  <p>ë˜í•œ ìƒíƒœ ê°€ì¹˜ì— ëŒ€í•œ í• ì¸ìœ¨ë„ ì •ì˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
<pre class="language-python" tabindex="0">
<code class="language-python">
# The discount for each (s, a) pair.
discounts = jnp.where(transition_matrix > 0, 1.0, 0.0)
</code>
</pre>

  <p><code>transition_matrix</code>ì˜ ê°’ì´ 0, ì¦‰ ë‹¤ìŒ ìƒíƒœê°€ ì—†ëŠ” ê²½ìš° í• ì¸ìœ¨ì´ 0ì´ ë©ë‹ˆë‹¤.</p>

  <h3>5.3. ìƒíƒœ ê°€ì¹˜ì˜ ì´ˆê¸°ê°’</h3>
  <p>ê° ìƒíƒœì˜ ì´ˆê¸° ê°€ì¹˜ëŠ” 15ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” íƒìƒ‰ ì´ˆê¸°ì— ëª¨ë“  ìƒíƒœë¥¼ ë‚™ê´€ì ìœ¼ë¡œ í‰ê°€í•˜ì—¬ íƒí—˜(exploration)ì„ ì¥ë ¤í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.</p>
<pre class="language-python" tabindex="0">
<code class="language-python">
# Using optimistic initial values to encourage exploration.
values = jnp.full([num_states], 15.0)
</code>
</pre>

  <h3>5.4. ì •ì±… ë„¤íŠ¸ì›Œí¬ì˜ ì‚¬ì „ í™•ë¥ </h3>
  <p>ê° ìƒíƒœì—ì„œ ì •ì±… ë„¤íŠ¸ì›Œí¬ê°€ ì¶œë ¥í•˜ëŠ” ì‚¬ì „ í™•ë¥ ì˜ logitsì€ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” íƒìƒ‰ ì´ˆê¸° ë‹¨ê³„ì—ì„œ ëª¨ë“  í–‰ë™ì´ ë™ì¼í•œ í™•ë¥ ì„ ê°–ë„ë¡ í•©ë‹ˆë‹¤.</p>
<pre class="language-python" tabindex="0">
<code class="language-python">
# The prior policies for each state.
all_prior_logits = jnp.zeros_like(rewards)
</code>
</pre>

  <h3>5.5. ë£¨íŠ¸ ë…¸ë“œì™€ ìƒíƒœ ì „ì´ í•¨ìˆ˜ í˜¸ì¶œ ì˜ˆì‹œ</h3>
  <p><code>_make_batched_env_model</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë£¨íŠ¸ ë…¸ë“œì™€ ìƒíƒœ ì „ì´ í•¨ìˆ˜ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.</p>
<pre class="language-python" tabindex="0">
<code class="language-python">
def _make_batched_env_model(
    batch_size: int,
    *,
    transition_matrix: chex.Array,
    rewards: chex.Array,
    discounts: chex.Array,
    values: chex.Array,
    prior_logits: chex.Array):
  """Returns a batched `(root, recurrent_fn)`."""
  chex.assert_equal_shape([transition_matrix, rewards, discounts,
                           prior_logits])
  num_states, num_actions = transition_matrix.shape
  chex.assert_shape(values, [num_states])
  # We will start the search at state zero.
  root_state = 0
  root = mctx.RootFnOutput(
      prior_logits=jnp.full([batch_size, num_actions],
                            prior_logits[root_state]),
      value=jnp.full([batch_size], values[root_state]),
      # The embedding will hold the state index.
      embedding=jnp.zeros([batch_size], dtype=jnp.int32),
  )

  def recurrent_fn(params, rng_key, action, embedding):
    del params, rng_key
    chex.assert_shape(action, [batch_size])
    chex.assert_shape(embedding, [batch_size])
    recurrent_fn_output = mctx.RecurrentFnOutput(
        reward=rewards[embedding, action],
        discount=discounts[embedding, action],
        prior_logits=prior_logits[embedding],
        value=values[embedding])
    next_embedding = transition_matrix[embedding, action]
    return recurrent_fn_output, next_embedding

  return root, recurrent_fn
</code>
</pre>
<pre class="language-python" tabindex="0">
<code class="language-python">
root, recurrent_fn = _make_batched_env_model(
    # Using batch_size=2 to test the batched search.
    batch_size=2,
    transition_matrix=transition_matrix,
    rewards=rewards,
    discounts=discounts,
    values=values,
    prior_logits=all_prior_logits
)
</code>
</pre>

  <p>ë£¨íŠ¸ ë…¸ë“œëŠ” <code>RootFnOutput</code> íƒ€ì…ìœ¼ë¡œ, <code>ì‚¬ì „ í™•ë¥ </code>, <code>ê°€ì¹˜</code>, <code>ìƒíƒœ ì„ë² ë”©</code>ì„ ë³´ìœ í•©ë‹ˆë‹¤.</p>
  <p>MuZeroì—ì„œëŠ” ì´ ì„ë² ë”©ì´ ìƒíƒœë¥¼ í‘œí˜„í•˜ëŠ” ë²¡í„°ê°€ ë˜ì§€ë§Œ, ì´ ì˜ˆì œì—ì„œëŠ” ìƒíƒœì˜ ì¸ë±ìŠ¤ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
  <p>ìƒíƒœ ì „ì´ í•¨ìˆ˜ <code>recurrent_fn</code>ì€ í˜„ì¬ ìƒíƒœì˜ <code>embedding</code>ê³¼ ì„ íƒëœ <code>action</code>ì„ ì…ë ¥ë°›ì•„, ì „ì´ ê³¼ì •ì—ì„œ ì–»ëŠ” ì •ë³´(<code>RecurrentFnOutput</code>)ì™€ ë‹¤ìŒ ìƒíƒœì˜ <code>embedding</code>ì„ ë°˜í™˜í•©ë‹ˆë‹¤.</p>
  <p>ë°°ì¹˜ ë‹¨ìœ„ íƒìƒ‰ì„ ìœ„í•´ ê° ë°ì´í„°ì˜ ì²« ë²ˆì§¸ ì°¨ì›ì€ ë°°ì¹˜ í¬ê¸°ê°€ ë©ë‹ˆë‹¤.</p>

  <h3>5.6. <code>gumbel_muzero_policy</code> í˜¸ì¶œ ì˜ˆì‹œ</h3>
  <p><code>visualization_demo.py</code>ì—ì„œëŠ” ìœ„ì—ì„œ ì •ì˜í•œ êµ¬ì„± ìš”ì†Œë“¤ì„ <code>gumbel_muzero_policy</code>ì— ì „ë‹¬í•˜ì—¬ íƒìƒ‰ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p>
<pre class="language-python" tabindex="0">
<code class="language-python">
# Running the search.
policy_output = mctx.gumbel_muzero_policy(
    params=(),
    rng_key=rng_key,
    root=root,
    recurrent_fn=recurrent_fn,
    num_simulations=FLAGS.num_simulations,
    max_depth=FLAGS.max_depth,
    max_num_considered_actions=FLAGS.max_num_considered_actions,
)
</code>
</pre>

  <p>ì¸ìˆ˜ëŠ” <code>rng_key</code>, ë£¨íŠ¸ ë…¸ë“œ(<code>root</code>), ìƒíƒœ ì „ì´ í•¨ìˆ˜(<code>recurrent_fn</code>), ì‹œë®¬ë ˆì´ì…˜ íšŸìˆ˜(<code>num_simulations</code>), íƒìƒ‰ ê¹Šì´(<code>max_depth</code>), ë£¨íŠ¸ ë…¸ë“œì˜ ìµœëŒ€ í–‰ë™ ìˆ˜(<code>max_num_considered_actions</code>)ì…ë‹ˆë‹¤.</p>
  <p>ì°¸ê³ ë¡œ <code>rng_key</code>ëŠ” ë‚œìˆ˜ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.</p>
  <p>íƒìƒ‰ì´ ì™„ë£Œë˜ë©´ <code>policy_output</code> ê°ì²´ì— ê²°ê³¼ê°€ ë‹´ê²¨ ë°˜í™˜ë©ë‹ˆë‹¤. <code>policy_output.action</code>ì€ íƒìƒ‰ì„ í†µí•´ ê²°ì •ëœ ìµœì ì˜ í–‰ë™ì„, <code>policy_output.action_weights</code>ëŠ” ì •ì±… ë„¤íŠ¸ì›Œí¬ í•™ìŠµì— ì‚¬ìš©ë  ìˆ˜ ìˆëŠ” ëª©í‘œ í™•ë¥ ê°’ì„ ë‹´ê³  ìˆìŠµë‹ˆë‹¤.</p>

  <h2>6. ğŸ ë§ˆì¹˜ë©°</h2>
  <p>ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” <code>Gumbel AlphaZero</code>ì˜ ê¸°ë³¸ ê°œë…ê³¼ ê·¸ ê¸°ë°˜ì´ ë˜ëŠ” <code>Mctx</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ëŒ€í•´ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤. <code>Mctx</code>ì˜ ì„¤ì¹˜ ë°©ë²•ê³¼ <code>visualization_demo.py</code> ì˜ˆì œë¥¼ í†µí•´ íƒìƒ‰ ì•Œê³ ë¦¬ì¦˜ì´ ì–´ë–¤ êµ¬ì„± ìš”ì†Œë“¤ì„ í•„ìš”ë¡œ í•˜ê³  ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤.</p>
  <p><%= link_to "ë‹¤ìŒ í¬ìŠ¤íŠ¸", post_by_slug_path("2025-09-04-gumbel-alphazero-02"), class: "next-post-link" %>ì—ì„œëŠ” <code>Gumbel AlphaZero</code>ì˜ í•µì‹¬ì´ë¼ í•  ìˆ˜ ìˆëŠ” <strong>í–‰ë™ ì„ íƒ(Action Selection)</strong> ì•Œê³ ë¦¬ì¦˜, íŠ¹íˆ <code>Gumbel-Top-k</code>ì™€ <code>ìˆœì°¨ì  ë°˜ê°ë²•</code>ì— ëŒ€í•´ ë” ìì„¸íˆ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.</p>
</section>
